(function(){$(window).on("go",function(){return d3.json("data/world-110m.json",function(a,b){return a?void 0:(window.app.data.world=b,$(window).trigger("data-loaded"))})}),$(function(){return window.app={},window.app.data={},$(window).trigger("go")}),$(window).on("map-ready",function(){var a,b;return b=function(a){var b,c,d,e;return b=a.absolute,c=a.alpha,d=a.beta,e=a.gamma,null!=c||null!=d||null!=e?(window.app.data.orientation={absolute:b,alpha:c,beta:d,gamma:e},$(window).trigger("orientation-changed")):void 0},a=function(a){var b,c,d;return b=a.accelerationIncludingGravity.x,c=a.accelerationIncludingGravity.y,d=a.accelerationIncludingGravity.z},window.addEventListener("deviceorientation",b,!0),window.addEventListener("devicemotion",a,!0)}),$(window).on("data-loaded",function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;return o=[void 0],m=o[0],g=o[1],j=o[2],c=o[3],b=o[4],i=o[5],f=o[6],p=[void 0],e=p[0],n=p[1],h=p[2],d=p[3],a=p[4],l=function(){return m=$("#vis").width(),g=$("#vis").width(),j=d3.geo.orthographic().translate([m/2,g/2]).scale(m/2).clipAngle(90),c=d3.select("#vis").append("canvas").attr({width:m,height:g}),b=c.node().getContext("2d"),f=d3.geo.graticule(),i=d3.geo.path().projection(j).context(b),e={type:"Sphere"},n=window.app.data.world,h=topojson.feature(n,n.objects.land),d=topojson.feature(n,n.objects.countries).features,a=topojson.mesh(n,n.objects.countries,function(a,b){return a!==b}),b.font="20px Dosis",b.fillText("BEST VIEWED ON ",0,50),b.fillText("PORTABLE DEVICES",0,80),b.fillText("(SERIOUSLY)",0,110),$(window).trigger("map-ready")},k=function(){var a,c,k,l,n,o;return n=window.app.data.orientation,null!=n&&null!=n.beta&&null!=n.gamma&&null!=n.alpha?j.rotate([-n.gamma,n.beta,-n.alpha]):(l=1,o=d3.geo.centroid(d[l]),j.rotate([-o[0],-o[1]])),k="#91cde3",c="#FF8400",a="#3C3C3C",b.fillStyle=a,b.clearRect(0,0,m,g),b.fillStyle=k,b.beginPath(),i(e),b.fill(),b.fillStyle=c,b.strokeStyle="white",b.lineWidth=2,b.beginPath(),i(h),b.fill(),b.stroke(),b.strokeStyle="white",b.lineWidth=.5,b.beginPath(),i(f()),b.stroke(),b.strokeStyle="white",b.lineWidth=.5,b.beginPath(),i(e),b.stroke()},l(),$(window).on("orientation-changed",k)})}).call(this);